<div class="container mt-4">
  <h4>Manage Pages</h4>
  <div *ngIf="loading" class="alert alert-info">Loading...</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <div class="row g-3 align-items-end">
    <div class="col-sm-4">
      <label class="form-label">Slug</label>
      <select class="form-select" [(ngModel)]="current.slug" (change)="loadSlug(current.slug)">
        <option *ngFor="let preset of presetSlugs()" [ngValue]="preset.slug">{{ preset.title }} ({{ preset.slug }})</option>
        <option disabled>────────</option>
        <option *ngFor="let p of pages" [ngValue]="p.slug">Existing: {{ p.slug }}</option>
      </select>
    </div>
    <div class="col-sm-4">
      <label class="form-label">Title</label>
      <input class="form-control" [(ngModel)]="current.title" />
    </div>
    <div class="col-sm-4 d-flex gap-2">
      <button class="btn btn-success" type="button" (click)="save()" [disabled]="saving">
        {{ saving ? 'Saving...' : 'Save' }}
      </button>
      <button class="btn btn-outline-secondary" type="button" (click)="loadSlug(current.slug)">Reload</button>
    </div>
  </div>

  <div class="mt-3">
    <label class="form-label">Content</label>
    <textarea class="form-control" rows="10" [(ngModel)]="current.content"></textarea>
  </div>

  <div class="mt-3">
    <h6>Existing pages</h6>
    <ul class="list-group">
      <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let p of pages">
        <span>{{ p.title }} ({{ p.slug }})</span>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-primary btn-sm" type="button" (click)="loadSlug(p.slug)">Edit</button>
          <button class="btn btn-outline-danger btn-sm" type="button" (click)="remove(p.slug)">Delete</button>
        </div>
      </li>
    </ul>
  </div>
</div>
