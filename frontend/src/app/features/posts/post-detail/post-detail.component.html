<div class="post-shell" *ngIf="post; else loadingTpl">
  <div class="post-header">
    <button class="btn btn-outline-secondary btn-sm" routerLink="/">Back</button>
    <div class="post-actions" *ngIf="isAdmin || isOwner">
      <a class="btn btn-outline-primary btn-sm" [routerLink]="['/posts', post.id, 'edit']">Edit</a>
      <button class="btn btn-outline-danger btn-sm" (click)="deletePost()" [disabled]="deleting">
        {{ deleting ? 'Deleting...' : 'Delete' }}
      </button>
    </div>
  </div>

  <article class="post-card">
    <h1>{{ post.title }}</h1>
    <div class="post-meta">
      <span class="badge bg-light text-dark">{{ post.categoryName }}</span>
      <span>By {{ post.authorUsername }}</span>
      <span *ngIf="post.createdAt">{{ post.createdAt | date: 'mediumDate' }}</span>
    </div>

    <div class="post-cover" *ngIf="post.coverImage">
      <img [src]="post.coverImage" alt="cover image" />
    </div>

    <div class="post-body">
      <p class="post-content">{{ post.content }}</p>
    </div>

    <div class="post-gallery" *ngIf="post.imageUrls.length">
      <h5>Gallery</h5>
      <div class="gallery-grid">
        <img *ngFor="let img of post.imageUrls" [src]="img" alt="gallery item" />
      </div>
    </div>
  </article>
</div>

<ng-template #loadingTpl>
  <div class="container mt-4">
    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
    <div *ngIf="!error" class="alert alert-info">Loading...</div>
  </div>
</ng-template>
