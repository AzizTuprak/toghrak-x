<div class="container py-4">
  <h4>Search</h4>
  <div class="input-group mb-3">
    <input
      class="form-control"
      [(ngModel)]="query"
      (keyup.enter)="runSearch()"
      placeholder="Search posts, pages, or socials"
      />
    <button class="btn btn-primary" type="button" (click)="runSearch()">Search</button>
  </div>

  @if (loading) {
    <div class="alert alert-info">Searching...</div>
  }
  @if (error) {
    <div class="alert alert-danger">{{ error }}</div>
  }

  @if (!loading && !error && !results.length) {
    <div class="text-muted">No results.</div>
  }

  @if (results.length) {
    <div class="list-group">
      @for (r of results; track r) {
        <a
          class="list-group-item list-group-item-action"
          [href]="r.type === 'SOCIAL' ? r.url : null"
          [routerLink]="r.type !== 'SOCIAL' ? r.url : null"
          [attr.target]="r.type === 'SOCIAL' ? '_blank' : null"
          >
          <div class="d-flex justify-content-between">
            <h6 class="mb-1">{{ r.title }}</h6>
            <span class="badge bg-secondary">{{ r.type }}</span>
          </div>
          <small class="text-muted">{{ r.url }}</small>
          @if (r.snippet) {
            <p class="mb-1">{{ r.snippet }}</p>
          }
        </a>
      }
    </div>
  }
</div>
